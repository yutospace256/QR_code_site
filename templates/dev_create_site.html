<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>QR Code Poonts</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      /* Style for the loading screen */
    #loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #f0f0f0;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    input[type="number"] {
        width: 100px;
        margin-bottom: 5px;
    }
    input[type="text"] {
        width: 300px;
        margin-bottom: 5px;
        height: 50x;
    }
    input[type="submit"] {
        width: 100px;
        margin-bottom: 5px;
        height: 50px;
    }
    textarea {
        width: 300px;
        height: 100px;
        margin-bottom: 5px;
    }
    label {
        display: inline-block;
        width: 100px;
    }
    label.choice {
        display: inline-block;
        width: 120px;
    }
    fieldset {
        margin: 10px;
    }
    </style>
<script>
    window.addEventListener('DOMContentLoaded', function() {
      var siteTypeRadioButtons = document.querySelectorAll('input[name="site_type"]');
      siteTypeRadioButtons.forEach(function(radioButton) {
        radioButton.addEventListener('change', showForm);
      });
      showForm();
    });
  
    function showForm() {
      var selectedOption = document.querySelector('input[name="site_type"]:checked').value;
      var formDiv = document.getElementById("formDiv");
  
      // Hide all form elements
      formDiv.innerHTML = "";
  
      if (selectedOption === "1") {
        // Create a form in which points is a number and title is up to 30 characters.
        formDiv.innerHTML = `
          <label for="points">Points:</label>
          <input type="number" id="points" name="points" class="number" min="0" required>
          <br>
          <label for="title">Title:</label>
          <input type="text" id="title" name="title" class="text" maxlength="30" required>
          <br>
          <input type="hidden" name="progress" value="step1">
        `;
      } else if (selectedOption === "2") {
        // Create a form where points is a number, title is up to 30 characters, and question is up to 256 characters.
        formDiv.innerHTML = `
          <label for="points">Points:</label>
          <input type="number" id="points" name="points" class="number" min="0" required>
          <br>
          <label for="title">Title:</label>
          <input type="text" id="title" name="title" class="text" maxlength="30" required>
          <br>
          <label for="question">Question:</label>
          <textarea id="question" name="question" class="textarea" maxlength="256" required></textarea>
          <br>
          <input type="hidden" name="progress" value="step1">
        `;
      } else if (selectedOption === "3") {
        // Create a form where points is a number, title is up to 30 characters, and hp is a number.
        formDiv.innerHTML = `
          <label for="points">Points:</label>
          <input type="number" id="points" name="points" class="number" min="0" required>
          <br>
          <label for="title">Title:</label>
          <input type="text" id="title" name="title" class="text" maxlength="30" required>
          <br>
          <label for="hp">HP:</label>
          <input type="number" id="hp" name="hp" class="number" min="0" max="1000" required>
          <br>
          <input type="hidden" name="progress" value="step1">
        `;
      }
    }
  </script>
  
</head>
 <body>
    <div id="loading-screen">
        <h1>Loading...</h1>
    </div>
    <script>
      window.addEventListener('load', function() {
          // When the page is fully loaded, hide the loading screen
          document.getElementById('loading-screen').style.display = 'none';
      });
    </script>
    <header>
      <h1>Welcome to Development Page for Create Game Site!</h1>
    </header>

    {% if progress != "step1" %}
      <table>
        <tbody>
          <caption style="margin:10px">Current Site Data: {{ new_site_number }}</caption><br>
          <tr>
              <th>Site Type</th>
              <th>Points</th>
              <th>Title</th>
              <th>HP</th>
              <th>Question</th>
          </tr>
          <tr>
            <td>{{ current_site_data["site_type"] }}</td>
            <td>{{ current_site_data["points"] }}</td>
            <td>{{ current_site_data["title"] }}</td>
            <td>{{ current_site_data["hp"] }}</td>
            <td>{{ current_site_data["question"] }}</td>
          </tr>
        </tbody>
    </table>
    {% endif %}

    {% if current_site_data and current_site_data["site_type"] == 2 %}
      <table>
        <tbody>
          <caption style="margin:10px">Current Choices Data: {{ new_site_number }}</caption><br>
          <tr>
              <th>Choice Value</th>
              <th>Choice Text</th>
          </tr>
          {% for choice in current_choices_data %}
            <tr>
              <td>{{ choice["value"] }}</td>
              <td>{{ choice["choice"] }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}

    {% if progress == "step1" %}
        <form name="create_site" method="POST" action="/create_site">
            <fieldset>
            <legend>Site Information</legend>
            <input type="radio" name="site_type" value="1" id="site_type_1" onchange="showForm()" checked>
            <label for="site_type_1">1 Normal</label>
            <input type="radio" name="site_type" value="2" id="site_type_2" onchange="showForm()">
            <label for="site_type_2">2 Quiz</label>
            <input type="radio" name="site_type" value="3" id="site_type_3" onchange="showForm()">
            <label for="site_type_3">3 HP</label>
            </fieldset>
            <div id="formDiv"></div>
            <button type="submit">Create Site</button>
        </form>
    {% elif progress == "step2" %}
      <form name="create_choices" method="POST" action="/create_site">
        <fieldset>
            <legend>Choices</legend>
            <!-- Create CHOICE in a form of 100 characters or less. -->
            <input type="radio" name="choice_value" value="0" id="choice_value_1" checked>
            <label for="choice_value_1" class="choice">0: Correct</label>
            <input type="radio" name="choice_value" value="X" id="choice_value_2">
            <label for="choice_value_2" class="choice">X: Incorrect</label>
        </fieldset>
        <br>
        <!-- Create CHOICE in a form of 100 characters or less. -->
        <label for="choice_text" class="choice">Choice Text:</label>
        <input type="text" id="choice_text" name="choice_text" class="text" maxlength="256">
        <button type="submit">Add Choices</button>
        <input type="hidden" name="progress" value="step2">
        <input type="hidden" name="new_site_number" value="{{ new_site_number }}">
      </form>    
      <form name="completed_create_choices" method="POST" action="/create_site">
        <button type="submit">Choice Creation Completed</button>
        <input type="hidden" name="progress" value="completed">
        <input type="hidden" name="new_site_number" value="{{ new_site_number }}">
      </form>
    {% elif progress == "completed" %}
        <!--After submitting, erase the form above and display the following-->
        <p>Site create completed</p>
    {% else %}
        <!-- Handle Invalid Progress Value -->
        <p>This is error page!</p>
    {% endif %}

    <a href="{{ url_for('develop') }}"><button class="back">Back</button></a>
    
  </body>
</html>